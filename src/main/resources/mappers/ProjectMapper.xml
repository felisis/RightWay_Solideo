<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.mark.mappers.ProjectMapper">
    <!-- Select 문 -->
    <select id="selectProject" resultType="ProjectVO">
        SELECT prj_num,prj_name, cus_num ,to_char(prj_start,'YYYY-MM-DD') AS prj_start ,to_char(prj_end,'YYYY-MM-DD') AS prj_end, prj_reg ,prj_upd FROM project
    </select>

    <!-- 사용자의 해당 프로젝트 리스트 불러오기 -->
    <select id="projectVOList" resultType="ProjectVO">
        select *
        from project natural join customer
        where cus_num = #{cus_num}
    </select>
    <!-- 프로젝트 추가(Insert) -->
    <insert id="insertProject" parameterType="ProjectVO" >
        insert into project(prj_num,prj_name,cus_num,prj_start,prj_end,prj_reg)
        values (prj_seq.nextval, #{prj_name}, #{cus_num},to_date(#{prj_start},'YYYY-MM-DD'), to_date(#{prj_end},'YYYY-MM-DD'), sysdate)
    </insert>

    <update id="updateProject" parameterType="ProjectVO" >
        update Project
        set prj_name = #{prj_name}, cus_num =#{cus_num} ,prj_start = to_date(#{prj_start},'YYYY-MM-DD'), prj_end= to_date(#{prj_end},'YYYY-MM-DD'),prj_upd=sysdate
        where prj_num = #{prj_num}
    </update>

    <select id="viewProject" resultType="ProjectVO">
        SELECT prj_num,prj_name, cus_num ,to_char(prj_start,'YYYY-MM-DD') AS prj_start ,to_char(prj_end,'YYYY-MM-DD') AS prj_end, prj_reg ,prj_upd FROM Project where prj_num=#{prj_num}
    </select>

    <delete id="delete">
        delete from Project where prj_num=#{prj_num}
    </delete>
</mapper>